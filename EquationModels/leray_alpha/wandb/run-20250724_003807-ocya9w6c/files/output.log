I0724 00:38:08.361818 8351751936 train.py:232] Training time window 1
Waiting for JIT...
[00:38:37 - main - INFO] -----------------------------
[00:38:37 - main - INFO] Iter:   0      Time: 28.298
[00:38:37 - main - INFO] -------------  --------------
[00:38:37 - main - INFO] p_ic_loss      1.959e-01
[00:38:37 - main - INFO] rc_loss        6.837e-02
[00:38:37 - main - INFO] ru_loss        5.535e-01
[00:38:37 - main - INFO] rv_loss        6.473e-01
[00:38:37 - main - INFO] u_ic_loss      3.186e-01
[00:38:37 - main - INFO] u_in_loss      1.594e-01
[00:38:37 - main - INFO] u_noslip_loss  5.063e-01
[00:38:37 - main - INFO] u_out_loss     1.792e-01
[00:38:37 - main - INFO] v_ic_loss      2.166e-01
[00:38:37 - main - INFO] v_in_loss      1.556e-01
[00:38:37 - main - INFO] v_noslip_loss  1.094e-01
[00:38:37 - main - INFO] v_out_loss     3.858e-02
[00:39:14 - main - INFO] -----------------------------
[00:39:14 - main - INFO] Iter: 100      Time: 37.025
[00:39:14 - main - INFO] -------------  --------------
[00:39:14 - main - INFO] p_ic_loss      8.549e-03
[00:39:14 - main - INFO] rc_loss        1.678e-02
[00:39:14 - main - INFO] ru_loss        7.980e-02
[00:39:14 - main - INFO] rv_loss        6.416e-02
[00:39:14 - main - INFO] u_ic_loss      3.150e-02
[00:39:14 - main - INFO] u_in_loss      1.842e-03
[00:39:14 - main - INFO] u_noslip_loss  6.674e-03
[00:39:14 - main - INFO] u_out_loss     5.981e-04
[00:39:14 - main - INFO] v_ic_loss      4.522e-02
[00:39:14 - main - INFO] v_in_loss      1.185e-03
[00:39:14 - main - INFO] v_noslip_loss  2.252e-03
[00:39:14 - main - INFO] v_out_loss     4.452e-04
I0724 00:39:48.183614 8351751936 checkpoints.py:571] Saving checkpoint at step: 200
I0724 00:39:48.183889 8351751936 checkpoints.py:659] Using Orbax as backend to save Flax checkpoints. For potential troubleshooting see: https://flax.readthedocs.io/en/latest/guides/training_techniques/use_checkpointing.html#orbax-as-backend-troubleshooting
I0724 00:39:48.184517 8351751936 abstract_checkpointer.py:35] orbax-checkpoint version: 0.11.14
I0724 00:39:48.185384 8351751936 checkpointer.py:241] [process=0] Started saving checkpoint to /Users/bkim/Dropbox/Research/Codes/jaxpinn/examples/ns_alpha/test1/ckpt/time_window_1/checkpoint_200.
I0724 00:39:48.190237 8351751936 atomicity.py:159] Creating tmp directory /Users/bkim/Dropbox/Research/Codes/jaxpinn/examples/ns_alpha/test1/ckpt/time_window_1/checkpoint_200.orbax-checkpoint-tmp-0
I0724 00:39:48.191144 8351751936 checkpoint.py:184] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1753285188190724000, 'commit_timestamp_nsecs': None, 'custom_metadata': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1753285188190724000, "commit_timestamp_nsecs": null, "custom_metadata": {}} to /Users/bkim/Dropbox/Research/Codes/jaxpinn/examples/ns_alpha/test1/ckpt/time_window_1/checkpoint_200.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA
I0724 00:39:48.193398 8351751936 signaling_client.py:334] Using ThreadSafeKeyValueSignalingClient
I0724 00:39:48.193602 8351751936 base_pytree_checkpoint_handler.py:137] [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.type_handlers.NumpyHandler".serialize. Time taken: 0.000520s
I0724 00:39:48.204315 8351751936 base_pytree_checkpoint_handler.py:116] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 271.2 MiB/s (total bytes: 3.4 MiB) (time elapsed: 12 milliseconds) (per-host)
I0724 00:39:48.204517 8351751936 base_pytree_checkpoint_handler.py:568] [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.012848s (batch_requests_ready=0.001364s, total_serialization_initiated=0.011144s, others=0.000340s)
I0724 00:39:48.222937 16693866496 array_metadata_store.py:243] [process=0][thread=write_metadata_after_commits] No metadata found for process_index=0, checkpoint_dir=/Users/bkim/Dropbox/Research/Codes/jaxpinn/examples/ns_alpha/test1/ckpt/time_window_1/checkpoint_200.orbax-checkpoint-tmp-0. If the checkpoint does not contain jax.Array then it is expected. If checkpoint contains jax.Array then it should lead to an error eventually; if no error is raised then it is a bug.
I0724 00:39:48.225714 16693866496 base_pytree_checkpoint_handler.py:968] [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 0.021248s (commit=0.018275s, array_metadata_write=0.002973s)
I0724 00:39:48.226243 8351751936 base_pytree_checkpoint_handler.py:116] [process=0] /jax/checkpoint/write/bytes_per_sec: 99.0 MiB/s (total bytes: 3.4 MiB) (time elapsed: 34 milliseconds) (per-host)
I0724 00:39:48.226611 8351751936 checkpoint.py:224] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1753285188190724000, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} from /Users/bkim/Dropbox/Research/Codes/jaxpinn/examples/ns_alpha/test1/ckpt/time_window_1/checkpoint_200.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA
I0724 00:39:48.226810 8351751936 checkpoint.py:243] Updated Metadata={'item_handlers': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler', 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1753285188190724000, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /Users/bkim/Dropbox/Research/Codes/jaxpinn/examples/ns_alpha/test1/ckpt/time_window_1/checkpoint_200.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA
I0724 00:39:48.227495 8351751936 array_metadata_store.py:279] [process=0][thread=MainThread] No metadata found for any process_index, checkpoint_dir=/Users/bkim/Dropbox/Research/Codes/jaxpinn/examples/ns_alpha/test1/ckpt/time_window_1/checkpoint_200.orbax-checkpoint-tmp-0. Time taken: 0.000079s. If the checkpoint does not contain jax.Array then it is expected. If checkpoint contains jax.Array then it should lead to an error eventually; if no error is raised then it is a bug.
I0724 00:39:48.229129 8351751936 base_pytree_checkpoint_handler.py:1086] [process=0][thread=MainThread] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.002169s. use_zarr3=False, enable_post_merge_validation=True, directory=/Users/bkim/Dropbox/Research/Codes/jaxpinn/examples/ns_alpha/test1/ckpt/time_window_1/checkpoint_200.orbax-checkpoint-tmp-0
I0724 00:39:48.229454 8351751936 atomicity.py:304] Renaming /Users/bkim/Dropbox/Research/Codes/jaxpinn/examples/ns_alpha/test1/ckpt/time_window_1/checkpoint_200.orbax-checkpoint-tmp-0 to /Users/bkim/Dropbox/Research/Codes/jaxpinn/examples/ns_alpha/test1/ckpt/time_window_1/checkpoint_200
I0724 00:39:48.229799 8351751936 atomicity.py:609] [process=0][thread=MainThread] Finished saving checkpoint (finalized tmp dir) to `/Users/bkim/Dropbox/Research/Codes/jaxpinn/examples/ns_alpha/test1/ckpt/time_window_1/checkpoint_200`.
I0724 00:39:48.229861 8351751936 checkpointer.py:288] Finished synchronous save in 0.04 seconds to /Users/bkim/Dropbox/Research/Codes/jaxpinn/examples/ns_alpha/test1/ckpt/time_window_1/checkpoint_200
